[gd_scene load_steps=33 format=4 uid="uid://3kup5s2id4qr"]

[ext_resource type="Texture2D" uid="uid://cf82simgc8u5y" path="res://unnamed (1).png" id="1_2hwuu"]
[ext_resource type="Texture2D" uid="uid://drnpfk5yaj406" path="res://ScissorsRPSS4GAME.png" id="2_54pdq"]
[ext_resource type="Texture2D" uid="uid://ctogwl5vyi1k2" path="res://PaperRPSS4Game.png" id="3_pwxiv"]
[ext_resource type="Texture2D" uid="uid://rdvdp6pjju21" path="res://RockRPS4Gamespritesheet.png" id="4_d3ae3"]
[ext_resource type="AudioStream" uid="uid://doof4nwbictfl" path="res://super-mario-64-thwomp-sound-online-audio-converter.mp3" id="5_nrap1"]
[ext_resource type="Texture2D" uid="uid://devnisj2oiys3" path="res://scissorsanimthatihaventsaidbeforeinprogress.png" id="6_f8q4u"]
[ext_resource type="Texture2D" uid="uid://ckrbfmpht2j4h" path="res://icon.svg" id="6_ychq1"]
[ext_resource type="Texture2D" uid="uid://dheyjkwr4xtwb" path="res://rpss tileset.png" id="7_shldc"]

[sub_resource type="GDScript" id="GDScript_jm67y"]
script/source = "extends CharacterBody2D

enum CharacterType { X, Y, Z }
var current_character: int = CharacterType.X

@export var sprite_x: Texture2D
@export var sprite_y: Texture2D
@export var sprite_z: Texture2D

@export var speed_x := 100
@export var speed_y := 175
@export var speed_z := 175

@export var gravity_scale_x := 1
#2.8
@export var gravity_scale_y := 0.35
#0.4
@export var gravity_scale_z := 0.2
#0.3
@export var jump_velocity_x := 0.0
@export var jump_velocity_y := -400.0
@export var jump_velocity_z := -400.0


var deathornotdeath := false
var ability_duration = 8
var amount_of_swaps = 0
var current_speed := 0.0
var current_gravity_scale := 1.0
var current_jump_velocity := 0.0
var can_jump := true

@onready var sprite: AnimatedSprite2D = $AnimatedSprite2D
@onready var audio: AudioStreamPlayer2D = $AudioStreamPlayer2D
@onready var Collision: CollisionShape2D = $CollisionShape2D
@onready var deadbox: CollisionShape2D = $Hurtbox/deadbox
var base_gravity := 0.0




func _ready():
	base_gravity = ProjectSettings.get_setting(\"physics/2d/default_gravity\")
	apply_character()

func _input(event):
	if event.is_action_pressed(\"swap_character\") and amount_of_swaps < 100:
		swap_character()
	if event.is_action_pressed(\"ability\"):
		use_ability()

func _physics_process(delta):
	if not is_on_floor():
		velocity.y += base_gravity * current_gravity_scale * delta

	var dir := Input.get_axis(\"move_left\", \"move_right\")
	velocity.x = dir * current_speed
	if sprite:
		sprite.flip_h = velocity.x < 0
		if abs(velocity.x) < 1:
			sprite.pause()
			sprite.frame = 0
		
		else:
			if not sprite.is_playing():
				sprite.play()
				
		if abs(velocity.x) < 1 and current_character == CharacterType.X:
				audio.play()
			

	if Input.is_action_just_pressed(\"Jump\") and is_on_floor() and can_jump:
		velocity.y = current_jump_velocity

	move_and_slide()

func swap_character():
	if current_character == CharacterType.X:
		current_character = CharacterType.Y
		apply_character()

	elif current_character == CharacterType.Y:
		current_character = CharacterType.Z
		apply_character()

	else:
		current_character = CharacterType.X
		apply_character()

	
	
func apply_character():
	match current_character:
		CharacterType.X:
			current_speed = speed_x
			current_gravity_scale = gravity_scale_x
			current_jump_velocity = jump_velocity_x
			can_jump = false
			amount_of_swaps = amount_of_swaps + 1
			print(amount_of_swaps)
			Collision.shape.extents = Vector2(15, 19)
			deadbox.shape.extents = Vector2(19, 15)
			if sprite and sprite_x:
				sprite.play(\"Rock\")
			floor_max_angle = 0

			
		CharacterType.Y:
			current_speed = speed_y
			current_gravity_scale = gravity_scale_y
			current_jump_velocity = jump_velocity_y
			can_jump = true
			amount_of_swaps = amount_of_swaps + 1
			print(amount_of_swaps)
			Collision.shape.extents = Vector2(19,14)
			deadbox.shape.extents = Vector2(14,20)
			if sprite and sprite_y:
				sprite.play(\"cutpaperthing\")
				floor_max_angle = 45
			

		CharacterType.Z:
			current_speed = speed_z
			current_gravity_scale = gravity_scale_z
			current_jump_velocity = jump_velocity_z
			can_jump = true
			amount_of_swaps = amount_of_swaps + 1
			print(amount_of_swaps)
			Collision.shape.extents = Vector2(20, 15)
			deadbox.shape.extents = Vector2(14, 22)
			if sprite and sprite_z:
				sprite.play(\"Paper\")
			
			

func use_ability():
	match current_character:
		CharacterType.X:
			x_ability()
		CharacterType.Y:
			y_ability()
		CharacterType.Z:
			z_ability()
func x_ability():
	current_speed = 1000
func y_ability():
	current_speed = 1000
func z_ability():
	current_speed = 1000
	current_gravity_scale = -0.1


func _on_hurtbox_body_entered(body: Node2D) -> void:
	if not deathornotdeath:
		die()

func die():
	deathornotdeath = true
	sprite.frame = 0
	sprite.pause()
	audio.play()
	set_physics_process(false)
	await get_tree().create_timer(1.5).timeout
	get_tree().reload_current_scene()
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_sbnov"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_oun7w"]
size = Vector2(25, 34)

[sub_resource type="AtlasTexture" id="AtlasTexture_h82qw"]
atlas = ExtResource("3_pwxiv")
region = Rect2(0, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_qd4yj"]
atlas = ExtResource("4_d3ae3")
region = Rect2(0, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_c5csp"]
atlas = ExtResource("4_d3ae3")
region = Rect2(32, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_72h0a"]
atlas = ExtResource("4_d3ae3")
region = Rect2(64, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_8wvw5"]
atlas = ExtResource("4_d3ae3")
region = Rect2(96, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_4s2f1"]
atlas = ExtResource("4_d3ae3")
region = Rect2(128, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_ymmx1"]
atlas = ExtResource("4_d3ae3")
region = Rect2(160, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_w5xre"]
atlas = ExtResource("4_d3ae3")
region = Rect2(192, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_a02hs"]
atlas = ExtResource("4_d3ae3")
region = Rect2(224, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_dscgp"]
atlas = ExtResource("2_54pdq")
region = Rect2(0, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_162o2"]
atlas = ExtResource("6_f8q4u")
region = Rect2(0, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_8xxjn"]
atlas = ExtResource("6_f8q4u")
region = Rect2(32, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_p60so"]
atlas = ExtResource("6_f8q4u")
region = Rect2(64, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_1y6tq"]
atlas = ExtResource("6_f8q4u")
region = Rect2(96, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_p0iaf"]
atlas = ExtResource("6_f8q4u")
region = Rect2(128, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_ntxjc"]
atlas = ExtResource("6_f8q4u")
region = Rect2(160, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_q3rww"]
atlas = ExtResource("6_f8q4u")
region = Rect2(192, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_4rgy8"]
atlas = ExtResource("6_f8q4u")
region = Rect2(224, 0, 32, 32)

[sub_resource type="SpriteFrames" id="SpriteFrames_xkvc5"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_h82qw")
}],
"loop": true,
"name": &"Paper",
"speed": 4.0
}, {
"frames": [{
"duration": 0.5,
"texture": SubResource("AtlasTexture_qd4yj")
}, {
"duration": 0.5,
"texture": SubResource("AtlasTexture_c5csp")
}, {
"duration": 0.5,
"texture": SubResource("AtlasTexture_72h0a")
}, {
"duration": 0.5,
"texture": SubResource("AtlasTexture_8wvw5")
}, {
"duration": 0.5,
"texture": SubResource("AtlasTexture_4s2f1")
}, {
"duration": 0.5,
"texture": SubResource("AtlasTexture_ymmx1")
}, {
"duration": 0.5,
"texture": SubResource("AtlasTexture_w5xre")
}, {
"duration": 0.5,
"texture": SubResource("AtlasTexture_a02hs")
}],
"loop": true,
"name": &"Rock",
"speed": 3.0
}, {
"frames": [{
"duration": 0.7,
"texture": SubResource("AtlasTexture_dscgp")
}, {
"duration": 0.7,
"texture": SubResource("AtlasTexture_162o2")
}, {
"duration": 0.7,
"texture": SubResource("AtlasTexture_8xxjn")
}, {
"duration": 0.7,
"texture": SubResource("AtlasTexture_p60so")
}, {
"duration": 0.7,
"texture": SubResource("AtlasTexture_1y6tq")
}, {
"duration": 0.7,
"texture": SubResource("AtlasTexture_p0iaf")
}, {
"duration": 0.7,
"texture": SubResource("AtlasTexture_ntxjc")
}, {
"duration": 0.7,
"texture": SubResource("AtlasTexture_q3rww")
}, {
"duration": 0.7,
"texture": SubResource("AtlasTexture_4rgy8")
}],
"loop": true,
"name": &"cutpaperthing",
"speed": 4.0
}]

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_yccqp"]
texture = ExtResource("7_shldc")
texture_region_size = Vector2i(32, 32)
0:0/0 = 0
0:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, -16, 16, -16, 16, 16, -16, 16)
1:0/0 = 0
1:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, -16, 16, -16, 16, 16, -16, 16)
2:0/0 = 0
2:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, -16, 16, -16, 16, 16, -16, 16)
3:0/0 = 0
3:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(16, 16, -16, 16, -16, 2.5, 16, 1.25)
0:1/0 = 0
0:1/0/physics_layer_0/polygon_0/points = PackedVector2Array(16, -16, 16, 16, -0.25, 16, 0.5, -16)
1:1/0 = 0
2:1/0 = 0
2:1/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, -16, 0, -16, -0.5, 16, -16, 16)
3:1/0 = 0
3:1/0/physics_layer_0/polygon_0/points = PackedVector2Array(9.5, -16, 13.25, 16, -12.5, 16, -9.25, -14)
0:2/0 = 0
0:2/0/physics_layer_0/polygon_0/points = PackedVector2Array(16, -16, 16, 16, -0.25, 16, 0.5, -16)
1:2/0 = 0
2:2/0 = 0
2:2/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, -16, 0, -16, -0.5, 16, -16, 16)
3:2/0 = 0
3:2/0/physics_layer_0/polygon_0/points = PackedVector2Array(9.5, -16, 13.25, 16, -12.5, 16, -9.25, -14)
0:3/0 = 0
0:3/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, -16, 16, -16, 16, 16, -16, 16)
1:3/0 = 0
1:3/0/physics_layer_0/polygon_0/points = PackedVector2Array(8.5, 16, -7.75, 16, -8, -16, 7.75, -16)
4:0/0 = 0
4:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(16, 9.5, 16, 16, -16, 16, -16, -16, -10, -14)
5:0/0 = 0
5:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, 6, -16, 16, 16, 16, 16, -16, 10, -14)
6:0/0 = 0
6:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, 16, -16, 16, -16, 16, -16, -16, -8.25, -16, 16, 16, -16, 16)
7:0/0 = 0
7:0/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, 16, -16, 16, -16, 16, 7.25, -16, 16, -16, 16, 16, -16, 16)
7:1/0 = 0
7:1/0/physics_layer_0/polygon_0/points = PackedVector2Array(-13.25, 10.75, -9.25, 4.5, -5.25, -1, -2, -6, 16, -5.75, 16, 16, -16, 16)
7:2/0 = 0
7:2/0/physics_layer_0/polygon_0/points = PackedVector2Array(16, -10.5, 16, 16, -16, 16, -16, 9.25, 2, -10.75)
6:2/0 = 0
6:2/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, -10.5, -16, 16, 16, 16, 16, 9.25, -2, -10.75)
6:1/0 = 0
6:1/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, -5.5, -16, 10, -16, 16, 16, 16, 16, 9.25, 3, -5.75)
5:1/0 = 0
5:1/0/physics_layer_0/polygon_0/points = PackedVector2Array(-11.75, 9.5, -16, 10, -16, 16, 16, 16, 16, 9.75, 16, 4.5, -11.25, 4)
5:2/0 = 0
5:2/0/physics_layer_0/polygon_0/points = PackedVector2Array(-6.5, 0.5, -16, 10, -16, 16, 16, 16, 16, 0.5)
4:2/0 = 0
4:2/0/physics_layer_0/polygon_0/points = PackedVector2Array(6.5, 0.5, 16, 10, 16, 16, -16, 16, -16, 0.5)
4:1/0 = 0
4:1/0/physics_layer_0/polygon_0/points = PackedVector2Array(11.75, 9.5, 16, 10, 16, 16, -16, 16, -16, 9.75, -16, 4.5, 11.25, 4)
4:3/0 = 0
5:3/0 = 0
5:3/0/physics_layer_0/polygon_0/points = PackedVector2Array(16, 9.25, 16, 16, -16, 16, -16, 9.25, -0.25, 9)
6:3/0 = 0
7:3/0 = 0
7:4/0 = 0
7:4/0/physics_layer_0/polygon_0/points = PackedVector2Array(16, -10.5, -16, 16, -16, -16, 16, -16)
6:4/0 = 0
6:4/0/physics_layer_0/polygon_0/points = PackedVector2Array(16, 16, -16, 16, -16, 10.75, 16, -16)
5:4/0 = 0
5:4/0/physics_layer_0/polygon_0/points = PackedVector2Array(16, 16, 16, 16, -16, 16, -16, -16)
4:4/0 = 0
4:4/0/physics_layer_0/polygon_0/points = PackedVector2Array(16, -16, 16, 16, -16, -9.5, -16, -16)
3:4/0 = 0
3:4/0/physics_layer_0/polygon_0/points = PackedVector2Array(16, -16, 16, 16, -16, 16, -16, -16)
3:3/0 = 0
3:3/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, -16, 16, -16, 16, 16, -16, 16)
2:3/0 = 0
2:3/0/physics_layer_0/polygon_0/points = PackedVector2Array(16, 16, -16, 16, -12, 0.5, 12, 0.75)
2:4/0 = 0
2:4/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, -16, 16, -16, 16, 16, -16, 16)
1:4/0 = 0
0:4/0 = 0
0:4/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, 16, -16, 16, -16, 16, -16, 16)
0:4/0/physics_layer_1/polygon_0/points = PackedVector2Array(-11.844, 2.65165, 13.0815, 3.53553, 12.5511, 16, -12.0208, 16)
0:5/0 = 0
0:5/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, 16, -16, 16, -16, 16, -16, 16)
0:5/0/physics_layer_1/polygon_0/points = PackedVector2Array(-11.844, 2.65165, 13.0815, 3.53553, 12.5511, 16, -12.0208, 16)
0:6/0 = 0
0:6/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, 16, -16, 16, -16, 16, -16, 16)
0:6/0/physics_layer_1/polygon_0/points = PackedVector2Array(-10.7834, 2.82843, 13.0815, 3.53553, 12.5511, 16, -10.9602, 16)
1:6/0 = 0
1:6/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, 16, -16, 16, -16, 16, -16, 16)
1:6/0/physics_layer_1/polygon_0/points = PackedVector2Array(-16, 3.18198, -3.88909, 3.35876, -4.41942, 16, -16, 16)
1:7/0 = 0
1:7/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, 16, -16, 16, -16, 16, -16, 16)
1:7/0/physics_layer_1/polygon_0/points = PackedVector2Array(-16, 3.18198, 16, 3.18198, 16, 16, -16, 16)
0:7/0 = 0
0:7/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, 16, -16, 16, -16, 16, -16, 16)
0:7/0/physics_layer_1/polygon_0/points = PackedVector2Array(-10.4298, 3.35876, 12.1976, 2.65165, 12.0208, 16, -10.0763, 16)
2:7/0 = 0
2:7/0/physics_layer_0/polygon_0/points = PackedVector2Array(-16, 16, -16, 16, -16, 16, -16, 16)
2:7/0/physics_layer_1/polygon_0/points = PackedVector2Array(-11.6673, 3.35876, 12.3744, 3.53553, 11.1369, 16, -12.1976, 16)

[sub_resource type="TileSet" id="TileSet_mxw0r"]
tile_size = Vector2i(32, 32)
physics_layer_0/collision_layer = 1
physics_layer_1/collision_layer = 2
physics_layer_1/collision_mask = 0
sources/1 = SubResource("TileSetAtlasSource_yccqp")

[node name="Node2D" type="Node2D"]
position = Vector2(184, 340)

[node name="CharacterBody2D" type="CharacterBody2D" parent="."]
texture_filter = 1
script = SubResource("GDScript_jm67y")
sprite_x = ExtResource("1_2hwuu")
sprite_y = ExtResource("3_pwxiv")
sprite_z = ExtResource("2_54pdq")

[node name="CollisionShape2D" type="CollisionShape2D" parent="CharacterBody2D"]
position = Vector2(75.5, -21.5)
rotation = -1.5708
shape = SubResource("RectangleShape2D_sbnov")
debug_color = Color(0.0179929, 0.642844, 0.302838, 0.42)

[node name="Camera2D" type="Camera2D" parent="CharacterBody2D"]
position = Vector2(76, -22)
zoom = Vector2(2, 2)
position_smoothing_enabled = true
position_smoothing_speed = 4.865

[node name="Hurtbox" type="Area2D" parent="CharacterBody2D"]
collision_layer = 0
collision_mask = 2

[node name="deadbox" type="CollisionShape2D" parent="CharacterBody2D/Hurtbox"]
position = Vector2(75.365, -23)
shape = SubResource("RectangleShape2D_oun7w")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="CharacterBody2D"]
show_behind_parent = true
texture_filter = 1
position = Vector2(76, -22)
scale = Vector2(1.47347, 1.47347)
sprite_frames = SubResource("SpriteFrames_xkvc5")
animation = &"Paper"

[node name="AudioStreamPlayer2D" type="AudioStreamPlayer2D" parent="CharacterBody2D"]
stream = ExtResource("5_nrap1")

[node name="TextureRect" type="TextureRect" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
texture = ExtResource("6_ychq1")
expand_mode = 1
metadata/_edit_use_anchors_ = true

[node name="TileMapLayer" type="TileMapLayer" parent="TextureRect"]
physics_interpolation_mode = 1
texture_filter = 1
position = Vector2(42, 65)
tile_map_data = PackedByteArray("AAAAAP7/AQAAAAAAAAABAP7/AQABAAAAAAACAP7/AQABAAAAAAADAP7/AQABAAAAAAAEAP7/AQACAAAAAAD///3/AQAFAAQAAAD+//z/AQAFAAQAAAAFAP7/AQABAAAAAAAGAP7/AQABAAAAAAAHAP7/AQABAAAAAAAIAP7/AQABAAAAAAAJAP7/AQABAAAAAAAKAP7/AQABAAAAAAALAP7/AQABAAAAAAD+//3/AQAEAAQAAAD9//z/AQAEAAQAAAD8//v/AQAEAAQAAAD7//r/AQAEAAQAAAD9//v/AQAFAAQAAAD8//r/AQAFAAQAAAAMAP7/AQABAAAAAAANAP7/AQABAAAAAAAOAP7/AQABAAAAAAAPAP7/AQABAAAAAAAQAP7/AQABAAAAAAARAP7/AQABAAAAAAAXAP7/AQABAAAAAAAWAP7/AQABAAAAAAAVAP7/AQABAAAAAAAUAP7/AQABAAAAAAATAP7/AQABAAAAAAASAP7/AQABAAAAAAAFAP3/AQAAAAUAAAAGAP3/AQAAAAUAAAAHAP3/AQAAAAUAAAAIAP3/AQAAAAUAAAADAP3/AQAGAAAAAAACAPz/AQAGAAAAAAAKAP3/AQADAAMAAAAJAP3/AQAHAAIAAAALAP3/AQAEAAAAAAAPAP3/AQAAAAMAAAANAP3/AQADAAAAAAATAP3/AQAAAAAAAAATAPz/AQAAAAAAAAATAPv/AQAAAAAAAAATAPr/AQAAAAAAAAATAPn/AQAAAAAAAAACAP3/AQAAAAMAAAA=")
tile_set = SubResource("TileSet_mxw0r")

[node name="TextEdit" type="TextEdit" parent="."]
offset_left = 195.0
offset_top = -108.0
offset_right = 329.0
offset_bottom = -33.0
text = "Hillel's a fag"

[connection signal="body_entered" from="CharacterBody2D/Hurtbox" to="CharacterBody2D" method="_on_hurtbox_body_entered"]
[connection signal="body_entered" from="CharacterBody2D/Hurtbox" to="CharacterBody2D/Hurtbox" method="_on_body_entered"]
[connection signal="finished" from="CharacterBody2D/AudioStreamPlayer2D" to="CharacterBody2D" method="_on_audio_stream_player_2d_finished"]
